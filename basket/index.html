<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
    <title>Lesson 5</title>
</head>
<body>
<section id="prod-list"></section>
<div id="basket"></div>
<div id="basket-body"></div>
<button id="clear-basket">Clear Basket</button>


<script>
    "use strict";

    let basket = {

        goodList: [],

        products: [
            {
                id: 1,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Виноградный напиток",
                prodPrice: 234,
                prodIngredient: "вино, шампанское"
            },
            {
                id: 2,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Адмирал",
                prodPrice: 423,
                prodIngredient: "вермут, виски"
            },
            {
                id: 3,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Апельсиновое цветение",
                prodPrice: 455,
                prodIngredient: "джин"
            },
            {
                id: 4,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Веселый еж",
                prodPrice: 774,
                prodIngredient: "вермут, виски"
            },
            {
                id: 5,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Апельсиновый делайт",
                prodPrice: 765,
                prodIngredient: "водка, ликер"
            },
            {
                id: 6,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Барьерный риф",
                prodPrice: 774,
                prodIngredient: "джин, ликер"
            },
            {
                id: 7,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль БИ И СИ",
                prodPrice: 231,
                prodIngredient: "кальвадос, ликер"
            },
            {
                id: 8,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Александр Невский",
                prodPrice: 776,
                prodIngredient: "водка, ликер"
            },
            {
                id: 9,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Водка 7",
                prodPrice: 986,
                prodIngredient: "водка"
            },
            {
                id: 10,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Вандербильта",
                prodPrice: 235,
                prodIngredient: "бренди, ликер, биттер"
            },
            {
                id: 11,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Биоплазма",
                prodPrice: 644,
                prodIngredient: "абсент, вино"
            },
            {
                id: 12,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Бункер",
                prodPrice: 300,
                prodIngredient: "виски"
            },
            {
                id: 13,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Ананасовый гудок",
                prodPrice: 455,
                prodIngredient: "джин, ликер"
            },
            {
                id: 14,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Апельсиновая водка",
                prodPrice: 877,
                prodIngredient: "водка, ликер"
            },
            {
                id: 15,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Брыкливая лошадь",
                prodPrice: 231,
                prodIngredient: "кальвадос, ром, вермут"
            },
            {
                id: 16,
                imgURL: "img/prod_img-1_200x200.jpg",
                prodName: "коктейль Белый груз",
                prodPrice: 765,
                prodIngredient: "джин"
            },
        ],

        countTotalPrice() {
            let totalCost = 0;
            this.goodList.forEach(function (item) {
                totalCost += item.prodPrice * item.count;
            });
            return totalCost;
        },

        countTotalNumber() {
            let totalCount = 0;
            this.goodList.forEach(function (item) {
                totalCount += item.count;
            });
            return totalCount;
        },

        putProduct(product) {
            let available = this.goodList.findIndex(function(item) {
                return item.name === product.name;
            });
            if (available === -1) {
                this.goodList.push(Object.assign({}, product));
                this.goodList[this.goodList.length - 1].count = 1;
            } else {
                this.goodList[available].count += 1;
            }
        },

        fillBasket(index){
            this.putProduct(this.products[index]);
        },

        generateProductHTML(index) {
            return `
            <div class="product" data-prodId="${basket.products[index].id}">
                <span id="prod-price"> Цена: ${basket.products[index].prodPrice}</span>
                <img src="${basket.products[index].imgURL}" alt="${basket.products[index].prodName}">
                <h4>${basket.products[index].prodName}</h4>
                <span>Ингредиенты:</span>
                <p class="prod-discr">${basket.products[index].prodIngredient}</p>
                <div class="ccd"><a href="#" id="buy-Button" class="ddott">Купить</a></div>
            </div>`;
        },

        generateAllProdHTML(products) {
            let allProdStr = "";
            for (let i = 0; i < products.length; i++) {
                allProdStr += this.generateProductHTML(i);
            }
            return allProdStr;
        },

        printProducts(selId, products) {
            let prodList = document.querySelector(selId);
            prodList.innerHTML = this.generateAllProdHTML(products);
        },

        generateBasketHTML() {
            return `
                    <h4>Корзина</h4>
                    <span>Вы ничего не положили в корзину!</span>
            `;
        },

        printBasket() {
            let basketBody = document.querySelector("#basket-body");
            basketBody.innerHTML = this.generateBasketHTML();
            if (this.goodList.length > 0) {
                this.printProducts("#basket-body", )
            }
        }
    };


    function showBasket() {

        // if (document.querySelector(".basket-body") == null) {
        //     let basketBody = document.createElement("div"),
        //         closeButton = document.createElement("div");
        //     basketBody.className = "basket-body";
        //     closeButton.id = "close";
        //     baskeForm.insertAdjacentElement("afterend", baskeForm.appendChild(basketBody));
        //     basketBody.insertAdjacentElement("afterbegin", basketBody.appendChild(closeButton));
        //     document.getElementById("close").onclick = closeBasket;
        //     console.log(basket.goodList);
        //     if (basket.goodList.length == []) {
        //         let par = document.createElement("p");
        //         par.innerHTML = "Козина пуста!";
        //         basketBody.insertAdjacentElement("beforeend", basketBody.appendChild(par));
        //     } else {
        //         let par = document.createElement("p");
        //         par.innerHTML =
        //             `Колличество ваших товаров: ${basket.countTotalNumber()}<br>Сумма покупки: ${basket.countTotalPrice()}`;
        //         basketBody.insertAdjacentElement("beforeend", basketBody.appendChild(par));
        //     }
        // } else {
        //     document.querySelector(".basket-body").remove();
        //     return showBasket();
        // }
    }

    function closeBasket() {
        document.querySelector(".basket-body").remove();
    }

    function clearBasket() {
        basket.goodList = [];
        basketIcon.style.display = "none";
    }
    basket.printProducts("#prod-list", basket.products);
    document.getElementById("clear-basket").onclick = clearBasket;
    //baskeForm.onclick = showBasket;
</script>
</body>
</html>